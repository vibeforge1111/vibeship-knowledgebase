# Vulnerability Article Template

Use this template for all pages at `/kb/security/vulnerabilities/{slug}/`

## JSON Content Structure

```json
{
  "title": "{Human-Readable Name}",
  "technicalName": "{Official Name} ({Acronym})",
  "slug": "{url-slug}",
  "description": "{150-160 char meta description with keyword and CTA}",
  
  "quickAnswer": "{30-50 word direct answer. Include what it is, why it matters, and the prevalence stat. This is the first thing LLMs extract.}",
  
  "stats": {
    "percentage": 23.4,
    "totalScanned": 10847,
    "trend": "up|down|stable",
    "weekOverWeekChange": 2.3,
    "mostAffectedTool": "cursor",
    "severity": "critical|high|medium|low"
  },
  
  "content": {
    "whatIsIt": "{100-150 words. Plain English definition. Real-world analogy. What could happen in concrete terms. No jargon without explanation.}",
    
    "aiPatternIntro": "{50-75 words explaining WHY AI tools generate this vulnerability. Set up the tool comparison.}",
    
    "aiPatternDetails": "{150-200 words in markdown. Specific patterns by tool. Why each tool makes this mistake. Include code examples of what AI generates.}",
    
    "impact": "{Markdown bullet list. 4-5 specific consequences. Use scary but accurate terms. Be concrete: 'Attackers can download your entire user database' not 'Data could be compromised'}",
    
    "detection": "{100-150 words. Specific code patterns to grep for. Regex patterns if helpful. What files to check. End with Scanner CTA.}",
    
    "manualFix": "{150-200 words with code. Show BEFORE (vulnerable) and AFTER (secure). Explain what changed and why. Include framework-specific notes.}"
  },
  
  "fixPrompt": "{200-400 word complete AI fix prompt. See Fix Prompt Template.}",
  
  "faqs": [
    {
      "question": "Is {vulnerability} still a real threat in {year}?",
      "answer": "{50-100 words. YES + data. Reference OWASP Top 10 if applicable. End with action.}"
    },
    {
      "question": "Does {popular tool/framework} protect against this?",
      "answer": "{50-100 words. Nuanced answer. Yes if X, but watch out for Y. Link to stack guide.}"
    },
    {
      "question": "How do I know if my app is vulnerable?",
      "answer": "{50-100 words. Quick check method + Scanner CTA.}"
    },
    {
      "question": "{Vulnerability-specific question}",
      "answer": "{50-100 words. Address common misconception or concern.}"
    },
    {
      "question": "What if I already shipped vulnerable code?",
      "answer": "{50-100 words. Don't panic. Steps to take. Link to fix prompt.}"
    }
  ],
  
  "stackNotes": [
    {
      "stack": "Next.js + Supabase",
      "stackSlug": "nextjs-supabase",
      "content": "{2-3 sentences. Stack-specific advice. Link to full guide.}"
    }
  ],
  
  "frameworkFixes": [
    {"name": "Next.js", "slug": "nextjs"},
    {"name": "Express", "slug": "express"},
    {"name": "SvelteKit", "slug": "sveltekit"}
  ],
  
  "relatedVulnerabilities": ["related-slug-1", "related-slug-2", "related-slug-3"],
  "relatedTools": ["cursor", "claude-code", "bolt"],
  "relatedStacks": ["nextjs-supabase", "express-postgres"],
  
  "cweId": "CWE-XXX",
  "owaspCategory": "AXX:2021-Category Name",
  
  "publishedAt": "2024-12-01T00:00:00Z",
  "updatedAt": "2024-12-15T00:00:00Z"
}
```

## Page Layout Structure

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Breadcrumb: KB > Security > Vulnerabilities > {Title}           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚ [Badge: Security Vulnerability] [Badge: Trending Up]            â”‚
â”‚                                                                 â”‚
â”‚ # {Title}                                                       â”‚
â”‚                                                                 â”‚
â”‚ {quickAnswer - this is the LLM extraction zone}                 â”‚
â”‚                                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ STATS BOX                                                   â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚ 23.4%  ðŸ“ˆ +2.3% vs last week                               â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚ Found in 2,538 of 10,847 AI-generated codebases            â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚ â”‚
â”‚ â”‚ Repos Scanned: 10,847  |  Affected: 2,538  |  Trend: +2.3% â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚ ## What is {Vulnerability}?                                     â”‚
â”‚ {whatIsIt content}                                              â”‚
â”‚                                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚ ## How AI Tools Cause This                                      â”‚
â”‚ {aiPatternIntro}                                                â”‚
â”‚                                                                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ TOOL CHART                                                  â”‚ â”‚
â”‚ â”‚ Cursor      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘  81%                  â”‚ â”‚
â”‚ â”‚ Bolt        â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘  74%                  â”‚ â”‚
â”‚ â”‚ Claude Code â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  67%                  â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â”‚ {aiPatternDetails}                                              â”‚
â”‚                                                                 â”‚
â”‚ [Link: See Cursor-specific patterns â†’]                          â”‚
â”‚                                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚ ## What Could Happen                                            â”‚
â”‚ {impact bullet list}                                            â”‚
â”‚                                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚ ## How to Detect It                                             â”‚
â”‚ {detection content}                                             â”‚
â”‚                                                                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ðŸ” Scan your code for {vulnerability} in 60 seconds        â”‚ â”‚
â”‚ â”‚                    [Free Security Scan â†’]                   â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚ ## How to Fix It                                                â”‚
â”‚                                                                 â”‚
â”‚ ### AI Fix Prompt                                               â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ðŸ› ï¸ AI Fix Prompt                    [Copy for Claude â†’]    â”‚ â”‚
â”‚ â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚ â”‚
â”‚ â”‚ {fixPrompt content}                                         â”‚ â”‚
â”‚ â”‚                                                             â”‚ â”‚
â”‚ â”‚ ðŸ’¡ Paste into Claude Code or Cursor                         â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â”‚ ### Manual Fix                                                  â”‚
â”‚ {manualFix with code blocks}                                    â”‚
â”‚                                                                 â”‚
â”‚ ### Framework-Specific Fixes                                    â”‚
â”‚ [Next.js â†’] [Express â†’] [SvelteKit â†’]                          â”‚
â”‚                                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚ ## Stack-Specific Notes                                         â”‚
â”‚ {stackNotes cards}                                              â”‚
â”‚                                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚ ## FAQ                                                          â”‚
â”‚ {FAQ accordion}                                                 â”‚
â”‚                                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚ ## Related                                                      â”‚
â”‚ Related vulnerabilities: [XSS] [IDOR] [Missing Auth]           â”‚
â”‚ Tool patterns: [Cursor] [Bolt] [Claude Code]                    â”‚
â”‚ Stack guides: [Next.js + Supabase] [Express]                   â”‚
â”‚                                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Last updated: December 15, 2024                                 â”‚
â”‚ Data: VibeShip Scanner analysis of 10,847 repositories          â”‚
â”‚ References: CWE-89, OWASP A03:2021                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Example: SQL Injection

### Title & Meta
- **Title:** SQL Injection: Find & Fix in AI-Generated Code | VibeShip
- **Meta:** SQL injection lets attackers steal your database. Found in 23% of AI-generated code. Get copy-paste fixes for Cursor, Bolt & Claude Code.
- **URL:** /kb/security/vulnerabilities/sql-injection/

### Quick Answer (First 50 Words)
> SQL injection happens when user input is placed directly into database queries. An attacker can type special characters that manipulate your queries, potentially reading, modifying, or deleting your entire database. We found this vulnerability in 23.4% of AI-generated codebases.

### What Is It (100-150 Words)
> SQL injection is like handing someone a blank check with your signature already on it. You expect them to fill in a reasonable amount, but nothing stops them from writing "one million dollars."
>
> When your code builds database queries by concatenating user input, attackers can inject their own SQL commands. Instead of searching for a username, they could tell your database to dump all user passwords, delete all records, or even take control of your server.
>
> This isn't theoreticalâ€”SQL injection has been in the OWASP Top 10 for over 20 years because it keeps working. AI coding tools make it worse by generating vulnerable patterns as their default approach.

### AI Fix Prompt (Complete)
```
Fix all SQL injection vulnerabilities in my codebase.

## What to look for

1. Template literals in SQL queries:
   - `SELECT * FROM users WHERE id = ${userId}`
   - `db.query(`SELECT * FROM ${table}`)`

2. String concatenation in SQL:
   - 'SELECT * FROM users WHERE id = ' + id
   - "SELECT * FROM users WHERE name = '" + name + "'"

3. Any user input (req.body, req.params, req.query, form data) placed directly into query strings

## How to fix

Replace string interpolation with parameterized queries:

### PostgreSQL (pg library)
```javascript
// Before
db.query(`SELECT * FROM users WHERE id = ${userId}`)

// After  
db.query('SELECT * FROM users WHERE id = $1', [userId])
```

### Supabase
```javascript
// Before (in RPC or raw SQL)
supabase.rpc('get_user', { sql: `WHERE id = ${userId}` })

// After (use client methods)
supabase.from('users').select('*').eq('id', userId)
```

### Prisma
```javascript
// Before
prisma.$queryRaw`SELECT * FROM users WHERE id = ${userId}`

// After
prisma.$queryRaw`SELECT * FROM users WHERE id = ${Prisma.sql`${userId}`}`
// Or better, use Prisma client:
prisma.user.findUnique({ where: { id: userId } })
```

## Framework-specific notes

- **Next.js API routes**: Check all /pages/api/ and /app/api/ files
- **Express**: Check all route handlers, especially req.params and req.query usage
- **Supabase**: The JS client is safe; watch for .rpc() and database functions

## After fixing

1. Search the entire codebase for remaining patterns: `\${.*}.*SELECT|INSERT|UPDATE|DELETE`
2. Add input validation to all user-facing endpoints
3. List all files you modified with before/after code snippets

Please proceed systematically, starting with API routes and database utility files.
```

### FAQ Examples

**Q: Is SQL injection still a real threat in 2024?**
> Yesâ€”it's been in the OWASP Top 10 for over 20 years because it keeps working. AI tools have actually increased its prevalence: we found SQL injection in 23% of AI-generated projects compared to 15% in traditionally-written code. Modern ORMs help, but raw query features reintroduce the risk.

**Q: Does Prisma protect against SQL injection?**
> Prisma's standard methods (findMany, create, etc.) are safe. However, $queryRaw and $executeRaw can be vulnerable if you use string interpolation. Always use Prisma.sql for parameterized raw queries, or better yet, stick to the type-safe client methods.
